<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SSP • Carnaval • Dashboard</title>

  <!-- Leaflet (mapa interativo) -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <!-- Heatmap plugin -->
  <script src="https://unpkg.com/leaflet.heat@0.2.0/dist/leaflet-heat.js"></script>

  <style>
    :root{
      --bg0:#070A12;
      --bg1:#0A0F1D;
      --panel: rgba(255,255,255,.045);
      --panel2: rgba(255,255,255,.06);
      --stroke: rgba(255,255,255,.10);
      --stroke2: rgba(255,255,255,.14);

      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.62);
      --muted2: rgba(255,255,255,.44);

      --accent:#4CC7FF;
      --accentSoft: rgba(76,199,255,.22);

      --tagBlue:#4C8DFF;
      --tagGreen:#36D47E;
      --tagYellow:#F5B940;
      --tagRed:#FF5C6C;
      --tagGray: rgba(255,255,255,.24);

      --topbar-h: 68px;
      --pad: 16px;
      --gap: 14px;
      --radius: 18px;
      --radius2: 22px;
      --shadow: 0 18px 55px rgba(0,0,0,.52);
    }

    *{ box-sizing:border-box; }
    html, body{ height:100%; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      color: var(--text);
      background:
        radial-gradient(1200px 700px at 18% -10%, rgba(76,199,255,.11), transparent 58%),
        radial-gradient(900px 650px at 78% 0%, rgba(147,88,255,.09), transparent 58%),
        radial-gradient(900px 650px at 60% 110%, rgba(54,212,126,.06), transparent 60%),
        linear-gradient(180deg, var(--bg1), var(--bg0));
      overflow: hidden;
    }

    .app{ height:100%; display:flex; flex-direction:column; }

    .topbar{
      height: var(--topbar-h);
      padding: 0 18px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      border-bottom: 1px solid rgba(255,255,255,.08);
      background: linear-gradient(180deg, rgba(255,255,255,.055), rgba(255,255,255,.02));
      backdrop-filter: blur(10px);
    }

    .top-left{
      display:flex;
      flex-direction:column;
      gap:4px;
      min-width: 420px;
    }
    .title{ font-weight: 750; font-size: 16px; letter-spacing: .01em; }
    .subtitle{ font-size: 12px; color: var(--muted2); }

    .top-center{
      display:flex;
      align-items:center;
      gap:10px;
      flex:1;
      justify-content:center;
    }

    .tabs{ display:flex; gap: 8px; align-items:center; }
    .tab{
      appearance:none;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.035);
      color: rgba(255,255,255,.70);
      padding: 10px 14px;
      border-radius: 999px;
      cursor:pointer;
      font-weight:700;
      font-size: 12px;
      letter-spacing:.06em;
      text-transform: uppercase;
      transition: background .18s ease, border-color .18s ease, transform .06s ease, color .18s ease;
      user-select:none;
    }
    .tab:hover{
      background: rgba(255,255,255,.06);
      border-color: rgba(255,255,255,.18);
      color: rgba(255,255,255,.86);
    }
    .tab:active{ transform: scale(.985); }
    .tab.active{
      color: rgba(255,255,255,.92);
      border-color: rgba(76,199,255,.30);
      background: linear-gradient(180deg, rgba(76,199,255,.16), rgba(255,255,255,.035));
      box-shadow: 0 12px 34px rgba(0,0,0,.35);
    }
    .tab[disabled]{ opacity:.45; cursor:not-allowed; }

    .top-right{
      display:flex;
      align-items:center;
      gap:10px;
      min-width: 420px;
      justify-content:flex-end;
    }

    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 8px 12px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
      color: rgba(255,255,255,.76);
      font-size: 12px;
      white-space: nowrap;
      backdrop-filter: blur(8px);
    }
    .dot{
      width: 8px; height: 8px;
      border-radius: 50%;
      background: var(--tagGreen);
      box-shadow: 0 0 0 5px rgba(54,212,126,.16);
    }
    .pill strong{ font-weight: 800; color: rgba(255,255,255,.86); }

    .content{
      height: calc(100% - var(--topbar-h));
      padding: var(--pad);
      display:flex;
      gap: var(--gap);
      overflow:hidden;
    }

    .page{ width:100%; height:100%; display:none; gap: var(--gap); }
    .page.active{ display:flex; }

    .left{
      flex: 0 0 46%;
      min-width: 560px;
      display:flex;
      flex-direction:column;
      gap: var(--gap);
      overflow:hidden;
    }
    .right{
      flex: 1;
      display:flex;
      flex-direction:column;
      gap: var(--gap);
      overflow:hidden;
    }

    .card{
      position:relative;
      border-radius: var(--radius2);
      border: 1px solid rgba(255,255,255,.10);
      background:
        radial-gradient(1000px 280px at 10% 0%, rgba(76,199,255,.10), transparent 55%),
        radial-gradient(900px 260px at 90% 10%, rgba(147,88,255,.07), transparent 55%),
        linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.03));
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .card::after{
      content:"";
      position:absolute; inset:-1px;
      pointer-events:none;
      border-radius: var(--radius2);
      background: radial-gradient(700px 240px at 50% 0%, rgba(255,255,255,.08), transparent 60%);
      opacity: .45;
      mix-blend-mode: screen;
    }

    .card-header{
      position:relative;
      z-index:1;
      padding: 12px 14px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      border-bottom: 1px solid rgba(255,255,255,.07);
      gap: 10px;
    }
    .card-title{
      font-size: 12px;
      color: rgba(255,255,255,.78);
      font-weight: 800;
      letter-spacing: .02em;
      white-space: nowrap;
    }

    .tag{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 6px 10px;
      border-radius: 999px;
      font-size: 11px;
      font-weight: 800;
      letter-spacing: .06em;
      text-transform: uppercase;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
      color: rgba(255,255,255,.74);
      white-space: nowrap;
    }
    .tag .mini-dot{ width: 8px; height: 8px; border-radius: 50%; background: rgba(255,255,255,.24); }
    .tag.blue .mini-dot{ background: #4C8DFF; box-shadow: 0 0 0 5px rgba(76,141,255,.16); }
    .tag.green .mini-dot{ background: #36D47E; box-shadow: 0 0 0 5px rgba(54,212,126,.16); }
    .tag.yellow .mini-dot{ background: #F5B940; box-shadow: 0 0 0 5px rgba(245,185,64,.14); }
    .tag.red .mini-dot{ background: #FF5C6C; box-shadow: 0 0 0 5px rgba(255,92,108,.14); }

    .card-body{ position:relative; z-index:1; padding: 14px; }

    .kpis{ display:grid; grid-template-columns: repeat(3, 1fr); gap: var(--gap); }
    .kpi-card{ min-height: 126px; }
    .kpi-top{ display:flex; flex-direction:column; gap:10px; }
    .kpi-value{ font-size: 34px; font-weight: 900; letter-spacing: .01em; min-height: 40px; }
    .kpi-sub{ font-size: 12px; color: rgba(255,255,255,.44); min-height: 14px; }

    .spark{
      margin-top: 10px;
      height: 22px;
      border-radius: 12px;
      overflow:hidden;
      opacity: .95;
      border: 1px solid rgba(255,255,255,.08);
      background: rgba(0,0,0,.16);
    }
    .spark svg{ width:100%; height:100%; display:block; }
    .spark path{
      fill:none;
      stroke: rgba(76,199,255,.72);
      stroke-width: 2.2;
      filter: drop-shadow(0 0 8px rgba(76,199,255,.25));
    }
    .spark .grid{ stroke: rgba(255,255,255,.06); stroke-width: 1; }

    .charts-row{ display:grid; grid-template-columns: 1fr 1fr; gap: var(--gap); }
    .chart-box{ height: 290px; }
    .chart-slot{
      height: 210px;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.10);
      background:
        radial-gradient(900px 220px at 20% 0%, rgba(76,199,255,.08), transparent 55%),
        rgba(0,0,0,.16);
    }
    .chart-note{ margin-top: 10px; font-size: 12px; color: rgba(255,255,255,.44); }

    .ranking-list{ display:flex; flex-direction:column; gap: 10px; min-height: 190px; }
    .ranking-item{
      display:grid;
      grid-template-columns: 34px 1fr 140px;
      gap: 10px;
      align-items:center;
      padding: 10px 12px;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.14);
    }
    .rank-num{
      width: 34px; height: 34px;
      border-radius: 14px;
      display:grid;
      place-items:center;
      font-weight: 900;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.04);
      color: rgba(255,255,255,.84);
    }
    .rank-name{ font-weight: 750; color: rgba(255,255,255,.82); min-height: 18px; }
    .rank-metric{ text-align:right; font-weight: 850; color: rgba(255,255,255,.78); min-height: 18px; }

    .map-card{ flex:1; display:flex; flex-direction:column; overflow:hidden; }
    #map{
      width:100%;
      height:100%;
      min-height: 560px;
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.10);
      overflow:hidden;
      background: rgba(0,0,0,.18);
    }

    .leaflet-control-zoom a{
      background: rgba(0,0,0,.45) !important;
      border: 1px solid rgba(255,255,255,.14) !important;
      color: rgba(255,255,255,.86) !important;
      backdrop-filter: blur(8px);
    }
    .leaflet-control-zoom a:hover{ background: rgba(255,255,255,.08) !important; }
    .leaflet-container{ background: rgba(0,0,0,.22); }

    .leaflet-control-layers{
      background: rgba(0,0,0,.50) !important;
      border: 1px solid rgba(255,255,255,.14) !important;
      color: rgba(255,255,255,.86) !important;
      border-radius: 14px !important;
      backdrop-filter: blur(10px);
      box-shadow: 0 18px 55px rgba(0,0,0,.45);
      overflow: hidden;
    }
    .leaflet-control-layers label{
      color: rgba(255,255,255,.86) !important;
      font-weight: 650;
    }
    .leaflet-control-layers-separator{ border-top: 1px solid rgba(255,255,255,.10) !important; }

    @media (max-width: 1360px){
      .left{ min-width: 520px; }
      .kpis{ grid-template-columns: repeat(2,1fr); }
      .charts-row{ grid-template-columns: 1fr; }
      .chart-box{ height: 270px; }
    }
  </style>
</head>

<body>
  <div class="app">
    <header class="topbar">
      <div class="top-left">
        <div class="title">Carnaval — SSP-BA — Megan Inteligência Artificial — Hive Computer Vision</div>
        <div class="subtitle">Dashboard em tempo real • atualização automática</div>
      </div>

      <div class="top-center">
        <nav class="tabs" aria-label="Abas do dashboard">
          <button class="tab active" data-tab="inicio">Início</button>
          <button class="tab" data-tab="aba2" disabled>Ocorrências</button>
          <button class="tab" data-tab="aba3" disabled>Zonas</button>
          <button class="tab" data-tab="aba4" disabled>Câmeras</button>
          <button class="tab" data-tab="aba5" disabled>Relatórios</button>
        </nav>
      </div>

      <div class="top-right">
        <div class="pill" title="Estado da atualização">
          <span class="dot" aria-hidden="true"></span>
          <span><strong>Atualização</strong> OK</span>
        </div>
        <div class="pill" title="Âncora (pronto para plugar no backend)">
          <span>Âncora: <strong id="anchorValue">—</strong></span>
        </div>
        <div class="pill" title="Data/Hora (pronto para plugar no backend)">
          <span id="clock">—</span>
        </div>
      </div>
    </header>

    <main class="content">
      <section class="page active" id="page-inicio">

        <div class="left">
          <div class="kpis">
            <div class="card kpi-card">
              <div class="card-header">
                <div class="card-title">Indicador 01</div>
                <div class="tag blue"><span class="mini-dot"></span>Ao vivo</div>
              </div>
              <div class="card-body kpi-top">
                <div class="kpi-value" id="kpi1-value"></div>
                <div class="kpi-sub" id="kpi1-sub"></div>
                <div class="spark" aria-hidden="true">
                  <svg viewBox="0 0 300 22" preserveAspectRatio="none">
                    <path class="grid" d="M0 11H300"></path>
                    <path d="M0 15 C30 7, 60 18, 90 10 S150 15, 180 9 S240 18, 300 12"></path>
                  </svg>
                </div>
              </div>
            </div>

            <div class="card kpi-card">
              <div class="card-header">
                <div class="card-title">Indicador 02</div>
                <div class="tag green"><span class="mini-dot"></span>Hoje</div>
              </div>
              <div class="card-body kpi-top">
                <div class="kpi-value" id="kpi2-value"></div>
                <div class="kpi-sub" id="kpi2-sub"></div>
                <div class="spark" aria-hidden="true">
                  <svg viewBox="0 0 300 22" preserveAspectRatio="none">
                    <path class="grid" d="M0 11H300"></path>
                    <path d="M0 12 C30 14, 60 8, 90 13 S150 10, 180 14 S240 7, 300 12"></path>
                  </svg>
                </div>
              </div>
            </div>

            <div class="card kpi-card">
              <div class="card-header">
                <div class="card-title">Indicador 03</div>
                <div class="tag yellow"><span class="mini-dot"></span>Max</div>
              </div>
              <div class="card-body kpi-top">
                <div class="kpi-value" id="kpi3-value"></div>
                <div class="kpi-sub" id="kpi3-sub"></div>
                <div class="spark" aria-hidden="true">
                  <svg viewBox="0 0 300 22" preserveAspectRatio="none">
                    <path class="grid" d="M0 11H300"></path>
                    <path d="M0 13 C40 8, 80 16, 120 11 S190 15, 220 10 S260 14, 300 12"></path>
                  </svg>
                </div>
              </div>
            </div>

            <div class="card kpi-card">
              <div class="card-header">
                <div class="card-title">Indicador 04</div>
                <div class="tag yellow"><span class="mini-dot"></span>Total</div>
              </div>
              <div class="card-body kpi-top">
                <div class="kpi-value" id="kpi4-value"></div>
                <div class="kpi-sub" id="kpi4-sub"></div>
                <div class="spark" aria-hidden="true">
                  <svg viewBox="0 0 300 22" preserveAspectRatio="none">
                    <path class="grid" d="M0 11H300"></path>
                    <path d="M0 14 C35 10, 70 15, 105 9 S170 15, 210 11 S270 17, 300 12"></path>
                  </svg>
                </div>
              </div>
            </div>

            <div class="card kpi-card">
              <div class="card-header">
                <div class="card-title">Indicador 05</div>
                <div class="tag red"><span class="mini-dot"></span>Alerta</div>
              </div>
              <div class="card-body kpi-top">
                <div class="kpi-value" id="kpi5-value"></div>
                <div class="kpi-sub" id="kpi5-sub"></div>
                <div class="spark" aria-hidden="true">
                  <svg viewBox="0 0 300 22" preserveAspectRatio="none">
                    <path class="grid" d="M0 11H300"></path>
                    <path d="M0 12 C35 16, 70 8, 110 14 S170 9, 210 16 S260 8, 300 12"></path>
                  </svg>
                </div>
              </div>
            </div>

            <div class="card kpi-card">
              <div class="card-header">
                <div class="card-title">Indicador 06</div>
                <div class="tag blue"><span class="mini-dot"></span>Ranking</div>
              </div>
              <div class="card-body kpi-top">
                <div class="kpi-value" id="kpi6-value"></div>
                <div class="kpi-sub" id="kpi6-sub"></div>
                <div class="spark" aria-hidden="true">
                  <svg viewBox="0 0 300 22" preserveAspectRatio="none">
                    <path class="grid" d="M0 11H300"></path>
                    <path d="M0 13 C30 9, 60 14, 100 10 S160 16, 200 9 S260 15, 300 12"></path>
                  </svg>
                </div>
              </div>
            </div>
          </div>

          <div class="charts-row">
            <div class="card chart-box">
              <div class="card-header">
                <div class="card-title">Gráfico de Rosca</div>
                <div class="tag green"><span class="mini-dot"></span>tempo real</div>
              </div>
              <div class="card-body">
                <div class="chart-slot" id="donut-chart" aria-label="Slot do gráfico de rosca"></div>
                <div class="chart-note">Slot pronto para receber dados do banco.</div>
              </div>
            </div>

            <div class="card chart-box">
              <div class="card-header">
                <div class="card-title">Gráfico de Barras</div>
                <div class="tag blue"><span class="mini-dot"></span>consolidado</div>
              </div>
              <div class="card-body">
                <div class="chart-slot" id="bar-chart" aria-label="Slot do gráfico de barras"></div>
                <div class="chart-note">Slot pronto para receber dados do banco.</div>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <div class="card-title">Ranking (Maior → Menor)</div>
              <div class="tag blue"><span class="mini-dot"></span>ranking</div>
            </div>
            <div class="card-body">
              <div class="ranking-list" id="ranking-list" aria-label="Lista de ranking"></div>
            </div>
          </div>
        </div>

        <div class="right">
          <div class="card map-card">
            <div class="card-header">
              <div class="card-title">Mapa Interativo</div>

              <div style="display:flex; gap:8px; align-items:center;">
                <button class="tab" type="button" onclick="focusBarraOndina()" style="padding:8px 12px;">Barra–Ondina</button>
                <button class="tab" type="button" onclick="focusRioVermelho()" style="padding:8px 12px;">Rio Vermelho</button>
                <div class="tag yellow"><span class="mini-dot"></span>zoom</div>
              </div>
            </div>

            <div class="card-body" style="height:100%;">
              <div id="map" aria-label="Mapa com zoom por clique e scroll"></div>
            </div>
          </div>
        </div>

      </section>

      <section class="page" id="page-aba2"></section>
      <section class="page" id="page-aba3"></section>
      <section class="page" id="page-aba4"></section>
      <section class="page" id="page-aba5"></section>
    </main>
  </div>

  <script>
    /* Tabs */
    const tabs = document.querySelectorAll(".tab[data-tab]");
    const pages = {
      inicio: document.getElementById("page-inicio"),
      aba2: document.getElementById("page-aba2"),
      aba3: document.getElementById("page-aba3"),
      aba4: document.getElementById("page-aba4"),
      aba5: document.getElementById("page-aba5"),
    };

    tabs.forEach(btn => {
      btn.addEventListener("click", () => {
        if (btn.disabled) return;
        tabs.forEach(b => b.classList.remove("active"));
        btn.classList.add("active");

        Object.values(pages).forEach(p => p.classList.remove("active"));
        const key = btn.dataset.tab;
        pages[key]?.classList.add("active");
      });
    });

    /* Clock */
    function pad2(n){ return String(n).padStart(2, "0"); }
    function tickClock(){
      const now = new Date();
      const d = `${pad2(now.getDate())}/${pad2(now.getMonth()+1)}/${now.getFullYear()}`;
      const t = `${pad2(now.getHours())}:${pad2(now.getMinutes())}:${pad2(now.getSeconds())}`;
      document.getElementById("clock").textContent = `Atualizado: ${d} ${t}`;
    }
    tickClock();
    setInterval(tickClock, 1000);

    /* ===========================
       MAPA (Leaflet)
    ============================ */
    const map = L.map("map", {
      zoomControl: true,
      scrollWheelZoom: true,
      doubleClickZoom: true,
      boxZoom: true,
      dragging: true
    });

    // Centro base (logo ajustamos por fitBounds no teste)
    map.setView([-12.997, -38.515], 13);

    L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
      maxZoom: 19,
      attribution: ""
    }).addTo(map);

    /* ===========================
       CAMADAS: ZONAS POR CÂMERA (polígonos)
    ============================ */
    const cameraZonesLayer = L.layerGroup().addTo(map);

    // TESTE: Zona Câmera 1 (4 pontos que você mandou)
    const CAMERA_1_ZONE = [
      [-13.01009, -38.53179],
      [-13.01004, -38.53133],
      [-13.00998, -38.53134],
      [-13.01004, -38.53178]
    ];

    const camera1Polygon = L.polygon(CAMERA_1_ZONE, {
      color: "#4CC7FF",
      weight: 3,
      opacity: 0.95,
      fillColor: "#4CC7FF",
      fillOpacity: 0.25
    }).addTo(cameraZonesLayer);

    camera1Polygon.bindTooltip("Zona Câmera 1", { sticky: true });

    // Marcar os vértices (só pra visual do teste)
    CAMERA_1_ZONE.forEach((p, idx) => {
      L.circleMarker(p, {
        radius: 5,
        weight: 2,
        color: "#ffffff",
        fillColor: "#4CC7FF",
        fillOpacity: 0.9
      }).addTo(cameraZonesLayer).bindTooltip(`P${idx+1}`, { permanent: false });
    });

    /* ===========================
       HEATMAPS (Entradas / Saídas / Presentes)
    ============================ */
    const HEAT_GRADIENT = {
      0.10: "#2b6cff",
      0.35: "#00c2ff",
      0.55: "#00e39a",
      0.75: "#f5b940",
      1.00: "#ff5c6c"
    };

    const heatEntradas = L.heatLayer([], {
      radius: 26, blur: 20, maxZoom: 17, minOpacity: 0.25,
      gradient: HEAT_GRADIENT
    });

    const heatSaidas = L.heatLayer([], {
      radius: 24, blur: 18, maxZoom: 17, minOpacity: 0.25,
      gradient: HEAT_GRADIENT
    });

    const heatPresentes = L.heatLayer([], {
      radius: 34, blur: 26, maxZoom: 17, minOpacity: 0.22,
      gradient: HEAT_GRADIENT
    });

    // Controle de camadas
    const overlays = {
      "Zonas • Câmeras": cameraZonesLayer,
      "Heatmap • Entradas": heatEntradas,
      "Heatmap • Saídas": heatSaidas,
      "Heatmap • Presentes": heatPresentes
    };
    L.control.layers(null, overlays, { collapsed: false, position: "topright" }).addTo(map);

    function updateHeatEntradas(points){ heatEntradas.setLatLngs(points || []); }
    function updateHeatSaidas(points){ heatSaidas.setLatLngs(points || []); }
    function updateHeatPresentes(points){ heatPresentes.setLatLngs(points || []); }

    // (mantive seu demo original, mas deixei desligado por padrão pra enxergar melhor a zona)
    // Se quiser ligar, descomente:
    // heatEntradas.addTo(map);
    // heatSaidas.addTo(map);

    /* ========= Focus / Zoom helpers (mantidos) ========= */
    const BOUNDS_BARRA_ONDINA = L.latLngBounds(
      L.latLng(-13.0200, -38.5450),
      L.latLng(-12.9950, -38.5000)
    );
    const BOUNDS_RIO_VERMELHO = L.latLngBounds(
      L.latLng(-12.9905, -38.5060),
      L.latLng(-12.9655, -38.4750)
    );

    function focusBarraOndina(){
      map.fitBounds(BOUNDS_BARRA_ONDINA, { padding: [18, 18] });
    }
    function focusRioVermelho(){
      map.fitBounds(BOUNDS_RIO_VERMELHO, { padding: [18, 18] });
    }

    // ✅ No teste: focar exatamente na Zona Câmera 1
    map.fitBounds(camera1Polygon.getBounds(), { padding: [40, 40] });

    /* ===========================
       Slots prontos (sem preencher nada agora)
    ============================ */
    function setKPI(id, valueText, subText){
      const v = document.getElementById(`${id}-value`);
      const s = document.getElementById(`${id}-sub`);
      if (v) v.textContent = valueText ?? "";
      if (s) s.textContent = subText ?? "";
    }

    function setRanking(items){
      const list = document.getElementById("ranking-list");
      list.innerHTML = "";
      (items || []).forEach((it, idx) => {
        const row = document.createElement("div");
        row.className = "ranking-item";

        const n = document.createElement("div");
        n.className = "rank-num";
        n.textContent = String(idx + 1);

        const name = document.createElement("div");
        name.className = "rank-name";
        name.textContent = it?.name ?? "";

        const metric = document.createElement("div");
        metric.className = "rank-metric";
        metric.textContent = it?.metric ?? "";

        row.appendChild(n);
        row.appendChild(name);
        row.appendChild(metric);
        list.appendChild(row);
      });
    }
  </script>
</body>
</html>
